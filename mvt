pol <- mvt
pol <- read.csv("mvt.csv",stringsAsFactors = F)
str(pol)
#extract the day of de week and the hour of the day
pol$Date <- strptime(pol$Date,format = "%m/%d/%y %H:%M")
Sys.setlocale("LC_TIME", "English")
pol$weekday <- weekdays(pol$Date)
pol$hour <- pol$Date$hour
str(pol)
weekcount <- as.data.frame(table(pol$weekday))
table(pol$weekday)
str(weekcount)
library(ggplot2)
ggplot(weekcount,aes(x=Var1,y=Freq))+geom_line(aes(group=1))
weekcount$Var1 <- factor(weekcount$Var1,ordered = T,levels = c("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"))
ggplot(weekcount,aes(x=Var1,y=Freq))+geom_line(aes(group=1))+xlab("Día de la semana")+ylab("Total Robo de vehículos")
ggplot(weekcount,aes(x=Var1,y=Freq))+geom_line(aes(group=1),linetype=2)+xlab("Día de la semana")+ylab("Total Robo de vehículos")
ggplot(weekcount,aes(x=Var1,y=Freq))+geom_line(aes(group=1),alpha=0.3)+xlab("Día de la semana")+ylab("Total Robo de vehículos")
dayhour <- as.data.frame(table(pol$weekday,pol$hour))
str(dayhour)
dayhour$hour <- as.numeric(as.character(dayhour$Var2))
ggplot(dayhour,aes(x=hour,y=Freq))+ geom_line(aes(group=Var1,color=Var1),size=2)
dayhour$Var1 <- factor(dayhour$Var1,ordered = T,levels = c("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"))
ggplot(dayhour,aes(x=hour,y=Var1))+geom_tile(aes(fill=Freq))
ggplot(dayhour,aes(x=hour,y=Var1))+geom_tile(aes(fill=Freq)) +scale_fill_gradient(name="Total robos")+theme(axis.title.y=element_blank())
ggplot(dayhour,aes(x=hour,y=Var1))+geom_tile(aes(fill=Freq)) +scale_fill_gradient(name="Total robos",low = "white",high = "red")+theme(axis.title.y=element_blank())
