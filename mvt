pol <- mvt
pol <- read.csv("mvt.csv",stringsAsFactors = F)
str(pol)
#extract the day of de week and the hour of the day
pol$Date <- strptime(pol$Date,format = "%m/%d/%y %H:%M")
Sys.setlocale("LC_TIME", "English")
pol$weekday <- weekdays(pol$Date)
pol$hour <- pol$Date$hour
str(pol)
weekcount <- as.data.frame(table(pol$weekday))
table(pol$weekday)
str(weekcount)
library(ggplot2)
ggplot(weekcount,aes(x=Var1,y=Freq))+geom_line(aes(group=1))
weekcount$Var1 <- factor(weekcount$Var1,ordered = T,levels = c("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"))
ggplot(weekcount,aes(x=Var1,y=Freq))+geom_line(aes(group=1))+xlab("Día de la semana")+ylab("Total Robo de vehículos")
ggplot(weekcount,aes(x=Var1,y=Freq))+geom_line(aes(group=1),linetype=2)+xlab("Día de la semana")+ylab("Total Robo de vehículos")
ggplot(weekcount,aes(x=Var1,y=Freq))+geom_line(aes(group=1),alpha=0.3)+xlab("Día de la semana")+ylab("Total Robo de vehículos")
dayhour <- as.data.frame(table(pol$weekday,pol$hour))
str(dayhour)
dayhour$hour <- as.numeric(as.character(dayhour$Var2))
ggplot(dayhour,aes(x=hour,y=Freq))+ geom_line(aes(group=Var1,color=Var1),size=2)
dayhour$Var1 <- factor(dayhour$Var1,ordered = T,levels = c("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"))
ggplot(dayhour,aes(x=hour,y=Var1))+geom_tile(aes(fill=Freq))
ggplot(dayhour,aes(x=hour,y=Var1))+geom_tile(aes(fill=Freq)) +scale_fill_gradient(name="Total robos")+theme(axis.title.y=element_blank())
ggplot(dayhour,aes(x=hour,y=Var1))+geom_tile(aes(fill=Freq)) +scale_fill_gradient(name="Total robos",low = "white",high = "red")+theme(axis.title.y=element_blank())
library(maps)
library(ggmap)
chi <- get_map(location = "chicago",zoom = 11)
ggmap(chi)
ggmap(chi)+geom_point(data=pol[1:100,],aes(x=Longitude,y=Latitude))
latlon <- as.data.frame(table(round(pol$Longitude,2),round(pol$Latitude,2)))
str(latlon)
latlon$long <- as.numeric(as.character(latlot$Var1))
latlon$lat <- as.numeric(as.character(latlot$Var2))
ggmap(chi)+geom_point(data = latlon,aes(x=long,y=lat,color= Freq,size=Freq))
ggmap(chi)+geom_point(data = latlon,aes(x=long,y=lat,color= Freq,size=Freq))+scale_color_gradient(low = "yellow", high = "red")
ggmap(chi)+geom_tile(data = latlon,aes(x=long,y=lat,alpha=Freq),fill="red")
latlon2 <- subset(latlon,Freq>0)
ggmap(chi)+geom_tile(data = latlon2,aes(x=long,y=lat,alpha=Freq),fill="red")
