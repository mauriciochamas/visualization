library(ggplot2)
library(maps)
library(ggmap)
staMap <- map_data("state")
str(staMap)
table(staMap$group)
length(table(staMap$group))
ggplot(staMap,aes(x=long,y=lat,group=group))+geom_polygon(fill="white",color="pink")
poll <- PollingImputed
train <- subset(poll,Year< 2012)
test <- subset(poll,Year==2012)
mod <- glm(Republican~SurveyUSA+DiffCount,data = train, family="binomial")
pred <- predict(mod,newdata = test,type = "response")
rm(Pred)
predBinary <- as.numeric(pred>0.5)
predDF <- data.frame(pred,predBinary,test$State)
table(predBinary)
mean(pred)
predDF$region <- tolower(predDF$test.State)
predMap <- merge(staMap,predDF,by="region")
predMap <- predMap[order(predMap$order),]
ggplot(predMap,aes(x=long,y=lat,group=group,fill=predBinary))+geom_polygon(color="black")
ggplot(predMap,aes(x=long,y=lat,group=group,fill=predBinary))+geom_polygon(color="green")+scale_fill_gradient(low = "blue",high = "red",guide = "legend",breaks=c(0,1),labels=c("Democrat","Republican"),name="Prediction 2012")
ggplot(predMap,aes(x=long,y=lat,group=group,fill=pred))+geom_polygon(color="green",alpha=0.3)+scale_fill_gradient(low = "blue",high = "red",guide = "legend",breaks=c(0,1),labels=c("Democrat","Republican"),name="Prediction 2012")
?geom_polygon
